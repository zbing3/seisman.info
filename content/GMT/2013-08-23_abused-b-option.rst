GMT进阶之被滥用的-B选项
########################

:date: 2013-08-23 23:15
:author: SeisMan
:category: GMT
:tags: GMT选项
:slug: abused-b-option

.. contents::

GMT的官方文档里称“-B选项大概是GMT里最复杂的选项了，但是大多数情况下我们只需要使用其他最最简单的用法”。这篇博文的目的不是介绍-B选项复杂的语法，而是说说在GMT中使用-B选项的一个误区。

-J、-R、-B作为GMT最常用的三个选项，初学者印象深刻，不知不觉留下了“每个绘图命令都必须给出这三个选项”的印象。在前文《`GMT进阶之理解-J和-R的共生关系 <{filename}/GMT/2013-07-15_gmt-option-j-and-r.rst>`_\ 》中已经说到，-J和-R是一对好基友，几乎总是同时出现，并解释了一下二者关系那么好的原因（觉得没解释清，有些东西只可意会啊～）。

-B选项的身份比较尴尬。-B可以控制图形的边框的性质，但是没有-B顶多也就是图形没有边框而已，所以\ **-B不是绘图命令所必须的**\ 。这点大概就是本文的指导思想。

下面开始给一堆例子来说明这个问题。

第0个例子
=========

这个例子来自于前面的博文《\ `GMT使用-K和-O的技巧 <{filename}/GMT/2013-07-07_how-to-use-gmt-ko.rst>`_\ 》，两个psxy命令中间可以加上需要的各种命令，这里只是为了说明问题，所以就尽量简单。

.. code-block:: bash

 #!/bin/bash

 J="X6i"
 R="0/10/0/10"
 B="1/1"
 PS="TestB0.ps"

 psxy -J$J -R$R < /dev/null -K > $PS
 psxy -J$J -R$R < /dev/null -O >> $PS

这两条命令是用于开关GMT的，没有-B选项，其虽然生成了一些PS代码，但是实际却不显示任何内容。

第1个例子
=========

.. code-block:: bash

 #!/bin/bash

 J="X6i"
 R="0/10/0/10"
 B="1/1"
 PS="TestB1.ps"

 psxy -J$J -R$R -B$B < /dev/null -K > $PS
 psxy -J$J -R$R < /dev/null -O >> $PS

这个例子给第一个psxy命令加上了-B选项，当然也改了一下名字。看一下TestB1.ps会发现，-B的使用使得整个图形有了可见的边框，这是唯一的区别。

第2个例子
=========

.. code-block:: bash

 #!/bin/bash

 J="X6i"
 R="0/10/0/10"
 B="1/1"
 PS="TestB2.ps"

 psxy -J$J -R$R -B$B < /dev/null -K > $PS
 psxy -J$J -R$R -B$B < /dev/null -O >> $PS

这个例子给第二个psxy命令也加上了-B选项。看一下TestB2.ps会发现，这个图和例1的图是完全一样的。这意味着什么？第二个-B选项没有用还是两个-B选项画出的边框重合了？查看一下这三个ps文件的内容，试着搜索一下字符串gsave出现的次数，TestB0.ps出现1次，TestB01.ps出现2次，TestB02.ps出现3次。gsave具体是什么就不解释了，这表明第二个psxy命令的-B选项产生了很长一段代码，-B选项是有绘制边框的，只是两个边框重合了，看不出差别而已。

第3个例子
=========

.. code-block:: bash

 #!/bin/bash

 J="X6i"
 R="0/10/0/10"
 B="1/1"
 PS="TestB3.ps"

 psxy -J$J -R$R -B$B < /dev/null -K > $PS
 psxy -J$J -R$R -B$B -X1i < /dev/null -O >> $PS

这个例子在前一个例子的基础上加了个-X选项，将第二个psxy绘制的边框做了个偏移，可以看到ps文件中出现了两个边框，这个例子进一步证明了两个-B选项都是有绘制边框的。

小结
====

生成的四个ps文件的大小如下：

::

    TestB0.ps   16146
    TestB1.ps   38562
    TestB2.ps   60978
    TestB3.ps   60993

-  第1个例子中的一个-B选项加入了边框，使得TestB1.ps比TestB0.ps大了不少，这个是没办法的，画图需要边框就要付出一些代价，多一些代码，文件大小大了一点。
-  第2个例子中加入的第二个-B选项使得TestB2.ps比TestB1.ps又大了很多，而在显示效果上没有任何区别，对于纯粹主义者来说，第二个-B选项是完全多余的。
-  第3个例子与第2个例子相比只是做了个偏移，文件内容基本没太大变化，所以TestB3.ps与TestB2.ps的大小基本没差。

总结
====

GMT的每个绘图命令绘制的都是一个图层，众多的绘图命令将多个图层叠加在一起，形成了一个复杂的GMT图形，这些绘图命令共享同一个图形边框，所以只需要第一个或者其中任意一个命令有-B选项就可以了，其他命令的-B选项没有任何效果，只会导致文件越来越大。有时候一张图里包含了多个子图，每个子图有自己的边框，这个时候每个子图的第一个命令都需要-B选项，其他命令都不需要。

好吧，差不多说完了，这篇博文没有太多实际用途。因为只用一个-B或者每个绘图命令都用-B，语法上都是对的，效果上是没有区别的，仅仅只是文件大小上有些区别，这年头硬盘都按T算了，基本也不在乎这么点空间。这篇博文或许有助于理解GMT的一些内部机制。

活用-B选项的一个例子
====================

理解-B选项还是有用的，比如这里的\ `绘制波形对比图 <{filename}/GMT/2013-09-15_waveform-comparison-plot.rst>`_\ 就是在正确理解了-B选项的用法之后绘制的结果。

修订历史
========

- 2013-08-22：初稿；
- 2013-09-15：增加了“活用-B选项的一个例子”；
