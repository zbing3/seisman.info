从SAC 101.6的一个bug谈起
#########################

:date: 2013-07-15 00:50
:author: SeisMan
:category: SAC
:tags: Bug
:slug: development-of-sac

2013年5月6日，SAC的维护者之一Arthur Snoke在邮件组中宣布101.6即将发布，提前公布了101.6的测试版，供感兴趣的人测试bug。

2013年5月16日，Arthur Snoke再次发送了类似的邮件。

2013年7月9日，IRIS宣布了SAC 101.6版正式发布。

5月21日，在使用101.6测试版的时候发现了一个bug，提交了Issue，Brain Savage在12个小时之后给我回复，说已经修复了这个bug。

7月13日，也就是在101.6正式版发布几天之后，再次发现了一个bug。本来信息完整的数据经过sort之后台站的所有信息都丢了。本来以为是我的误操作，查了一遍之后确认自己的脚本没有问题，最终将bug锁定在sort命令上。这个bug已经影响到了SAC的正常使用。我有些抱怨这些开发者的不负责任，怎么能将一个有这么明显bug的版本随随便便发布出来。从测试版到正式版之间2个月的时间居然没有把bug找出来。

翻看了一下关于101.6的所有邮件，在Arthur Snoke 5月16日的那封邮件中看到这样一句话：

    We hope that this time we will not need to got to v101.6b because
    there was a bug we missed.

这不禁让我想起了上一个版本，101.5-->101.5b-->101.5c，短短几天的时间内SAC就更新了两次，两次都是修正bug。突然理解了Arthur Snoke那句话的意思，理解了他话语中的无奈。

就目前看来，SAC还是存在很多的问题的。

- SAC的历史是个谜。在写SAC手册的时候，曾经想收集一下SAC的历史版本，整理一下其发展脉络。基本找不到有用的信息。了解到的一些信息大概如下：SAC最初是由LLNL开发的，当初使用的是Fortran，代码是非开源的，这个程序在地震学开始流行起来；后来不知道什么原因LLNL基本不再维护这个软件了，地震学赖以生存的一个重要软件面临着被淘汰的境地；然后IRIS出动了，其与LLNL签订了某某协议，SAC的开发就交给了IRIS，从此以后SAC的版本号开始以10x.x这样的形式出现。不知道是什么时候，SAC的源代码由Fortran改成了C，这个改变很不彻底，比如现在的C源代码中还有很多数组是从1开始的。
- SAC的代码很难看。没有条理，头文件太多，想看源码完全找不到头绪。
- SAC的读写子程序很落后，在实际应用中很难满足用户的需求。在这方面，Prof. Lupei Zhu的sacio.c以及sac.h要先进很多。当然由于不太清楚SAC的内部机制，所以不好说哪个更适合SAC。
- 子程序不够开放。目前用户可以调用的子程序包括滤波、相关、包络函数等几个，还有很多有用的子程序无法直接调用。

SAC最大的一个问题在于，缺乏专业的开发者以及专业的用户。开发者本身是地震学家，了解地震学家需要SAC做什么，但是其不可能花太多的时间去修改SAC的代码，精力有限，科研任务还是很重的。SAC的用户很多，搞地震学的基本都要用，专业的用户却很少，很多人只是使用SAC的几个命令，完全不关心其细节，这点从SAC邮件组的冷清就可以看出来，基本上一个月难得有人会提点问题。在测试的两个月内，几乎没有人提出bug（至少邮件组里没有看到），所有的bug都需要开发者自己去找。有写代码经验的人都知道，自己写的程序找bug是很困难。

SAC想要继续发展下去，还有很长的路要走，这个过程中需要更多的开发人员的付出，也需要更多用户的反馈。所以搞地震学的家伙们，下个最新版用一用，找找bug，为SAC的发展贡献一点力量吧。
